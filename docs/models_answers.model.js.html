<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/answers.model.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/answers.model.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const helperFunction = require('../helperfunction/helperFunction');

/**
 * @typedef {Object} IAnswerConf
 * @property {string} body
 * @property {number} user_id
 * @property {number} post_id
 */

/**
 * @param {IAnswerConf} answer
 * @property {string} body
 * @property {number} user_id
 * @property {number} post_id 
 */
const Answer = function(answer) {
    this.body = answer.body;
    this.user_id = answer.user_id;
    this.post_id = answer.post_id;
};

/**
 * @param {Answer} newAnswer
 * @param {(err: Error, data: string) => void} result
 */
Answer.create = (newAnswer, result) => {
    const query = `INSERT INTO answers(body,user_id,post_id) VALUES(?,?,?);`;

    pool.query(
        query,
        [newAnswer.body, newAnswer.user_id, newAnswer.post_id ],
        (err,res) => {
            if (err) {
                console.log('error: ', err);
                result(
                    helperFunction.responseHandler(false, err.statusCode, err.message, null),
                    null
                );
                return;
            }
            result(
                null,
                helperFunction.responseHandler(true, 200, 'Answer Added', res.insertId)
            );
        });
};

Answer.remove = (id, result) => {
    const query = ` DELETE FROM answers WHERE id = ?;`;

    pool.query(query,
        id,
        (err, res) => {
            if (err) {
                console.log('error: ', err);
                result(
                    helperFunction.responseHandler(false, err.statusCode, err.message, null),
                    null
                );
                return;
            }
            result(
                null,
                helperFunction.responseHandler(true, 200, 'Answer Removed', null)
            );
        });
}

Answer.retrieveAll = (postId, result) => {
    let query = ` SELECT
                    answers.id, post_id, answers.user_id, username, answers.body, answers.created_at 
                    FROM answers 
                    JOIN posts ON posts.id = post_id 
                    JOIN users ON users.id = answers.user_id 
                    WHERE post_id = ?;`;

    pool.query(query,
        postId,
        (err, results) => {
            if (err || results.length === 0) {
                console.log('error: ', err);
                result(
                    helperFunction.responseHandler(false, err ? err.statusCode : 404, err ? err.message : 'There are no answers', null),
                    null
                );
                return;
            }
            result(
                null,
                helperFunction.responseHandler(true, 200, 'Success', results)
            );
        });
}


module.exports = Answer;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Answer">Answer</a></li><li><a href="global.html#auth">auth</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Fri Nov 27 2020 13:18:36 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
